/**
 * @license
 * Cesium Analytics SDK
 * Version 1.128
 *
 * Copyright 2012-2020 Cesium GS, Inc.
 * All rights reserved.
 *
 * Patents US9153063B2 US9865085B1 US9449424B2 US10592242
 * Patents pending US15/829,786 US16/850,266 US16/851,958
 *
 * Portions licensed separately.
 * See https://github.com/CesiumGS/cesium/blob/main/LICENSE.md for open-source Cesium license.
 */

var IonSdkGeometry=(()=>{var ue=Object.create;var j=Object.defineProperty;var he=Object.getOwnPropertyDescriptor;var pe=Object.getOwnPropertyNames;var fe=Object.getPrototypeOf,me=Object.prototype.hasOwnProperty;var ge=(e,i)=>()=>(i||e((i={exports:{}}).exports,i),i.exports),ye=(e,i)=>{for(var t in i)j(e,t,{get:i[t],enumerable:!0})},ee=(e,i,t,a)=>{if(i&&typeof i=="object"||typeof i=="function")for(let n of pe(i))!me.call(e,n)&&n!==t&&j(e,n,{get:()=>i[n],enumerable:!(a=he(i,n))||a.enumerable});return e};var I=(e,i,t)=>(t=e!=null?ue(fe(e)):{},ee(i||!e||!e.__esModule?j(t,"default",{value:e,enumerable:!0}):t,e)),_e=e=>ee(j({},"__esModule",{value:!0}),e);var V=ge((Ae,ie)=>{ie.exports=Cesium});var Re={};ye(Re,{FanGeometry:()=>H,FanGeometryUpdater:()=>J,FanGraphics:()=>L,FanOutlineGeometry:()=>Y,Vector:()=>Z,VectorGraphics:()=>G,VectorVisualizer:()=>K,initializeGeometry:()=>$,processFan:()=>B,processVector:()=>U});var l=I(V(),1),A=new l.Cartesian3;function te(e){if(e=e??l.Frozen.EMPTY_OBJECT,!(0,l.defined)(e.directions))throw new l.DeveloperError("options.directions is required");if(!e.perDirectionRadius&&!(0,l.defined)(e.radius))throw new l.DeveloperError("options.radius is required when options.perDirectionRadius is undefined or false.");this._radius=e.radius,this._directions=e.directions,this._perDirectionRadius=e.perDirectionRadius,this._vertexFormat=e.vertexFormat??l.VertexFormat.DEFAULT,this._workerPath=(0,l.buildModuleUrl)("IonSdkGeometryWorkers/createFanGeometry.js")}te.createGeometry=function(e){if(!(0,l.defined)(e))throw new l.DeveloperError("fanGeometry is required");let i=e._vertexFormat,t=e._radius,a=(0,l.defined)(e._perDirectionRadius)&&e._perDirectionRadius,n=e._directions;n[0].clock<n[1].clock&&n.reverse();let o,s,g=0,c,r,v,y,w,S=new l.GeometryAttributes,b=[],O=[],D=n.length;for(c=0;c<D;c++)y=l.Cartesian3.fromSpherical(n[c]),c===0?(b.push(y),O.push(l.Cartesian3.normalize(y,new l.Cartesian3))):l.Cartesian3.equals(b[c-1],y)||(c===D-1?l.Cartesian3.equals(b[0],y)||(b.push(y),O.push(l.Cartesian3.normalize(y,new l.Cartesian3))):(b.push(y),O.push(l.Cartesian3.normalize(y,new l.Cartesian3))));if(D=b.length,i.position){w=(D+1)*2*3;let h=new Float64Array(w);for(r=0,c=0;c<D;c++){h[r++]=0,h[r++]=0,h[r++]=0,y=O[c];let T=a?l.Cartesian3.magnitude(b[c]):t;h[r++]=y.x*T,h[r++]=y.y*T,h[r++]=y.z*T,g=Math.max(g,T)}h[r++]=h[0],h[r++]=h[1],h[r++]=h[2],h[r++]=h[3],h[r++]=h[4],h[r++]=h[5],S.position=new l.GeometryAttribute({componentDatatype:l.ComponentDatatype.DOUBLE,componentsPerAttribute:3,values:h})}if(i.normal){w=(D+1)*2*3,o=new Float32Array(w);let h;for(r=0,c=0;c<D;c++)y=b[c],c+1===D?h=b[0]:h=b[c+1],A=l.Cartesian3.normalize(l.Cartesian3.cross(y,h,A),A),o[r++]=A.x,o[r++]=A.y,o[r++]=A.z,o[r++]=A.x,o[r++]=A.y,o[r++]=A.z;o[r++]=o[0],o[r++]=o[1],o[r++]=o[2],o[r++]=o[3],o[r++]=o[4],o[r++]=o[5],S.normal=new l.GeometryAttribute({componentDatatype:l.ComponentDatatype.FLOAT,componentsPerAttribute:3,values:o})}if(i.bitangent){for(w=(D+1)*2*3,s=new Float32Array(w),r=0,c=0;c<D;c++)y=O[c],s[r++]=y.x,s[r++]=y.y,s[r++]=y.z,s[r++]=y.x,s[r++]=y.y,s[r++]=y.z;s[r++]=s[0],s[r++]=s[1],s[r++]=s[2],s[r++]=s[3],s[r++]=s[4],s[r++]=s[5],S.bitangent=new l.GeometryAttribute({componentDatatype:l.ComponentDatatype.FLOAT,componentsPerAttribute:3,values:s})}if(i.tangent){w=(D+1)*2*3;let h=new Float32Array(w);for(r=0,c=0;c<w;c+=6){let T=l.Cartesian3.unpack(o,c),le=l.Cartesian3.unpack(s,c),z=l.Cartesian3.normalize(l.Cartesian3.cross(le,T,A),A);h[r++]=z.x,h[r++]=z.y,h[r++]=z.z,h[r++]=z.x,h[r++]=z.y,h[r++]=z.z}S.tangent=new l.GeometryAttribute({componentDatatype:l.ComponentDatatype.FLOAT,componentsPerAttribute:3,values:h})}if(i.st){w=(D+1)*2*2;let h=new Float32Array(w);for(r=0,c=0;c<D;c++)v=1-c/(D+1),h[r++]=v,h[r++]=0,h[r++]=v,h[r++]=1;v=1-c/(D+1),h[r++]=v,h[r++]=0,h[r++]=v,h[r++]=1,S.st=new l.GeometryAttribute({componentDatatype:l.ComponentDatatype.FLOAT,componentsPerAttribute:2,values:h})}r=0,c=0,w=(D+1)*2*3;let R=l.IndexDatatype.createTypedArray(w/3,w);for(;r<w-6;)R[r++]=c,R[r++]=c+3,R[r++]=c+1,R[r++]=c,R[r++]=c+2,R[r++]=c+3,c+=2;return R[r++]=c,R[r++]=1,R[r++]=c+1,R[r++]=c,R[r++]=0,R[r++]=1,new l.Geometry({attributes:S,indices:R,primitiveType:l.PrimitiveType.TRIANGLES,boundingSphere:new l.BoundingSphere(l.Cartesian3.ZERO,g)})};var H=te;var m=I(V(),1),F=new m.Cartesian3;function ne(e){if(e=e??m.Frozen.EMPTY_OBJECT,!(0,m.defined)(e.directions))throw new m.DeveloperError("options.directions is required");if(!e.perDirectionRadius&&!(0,m.defined)(e.radius))throw new m.DeveloperError("options.radius is required when options.perDirectionRadius is undefined or false.");this._radius=e.radius,this._directions=e.directions,this._perDirectionRadius=e.perDirectionRadius,this._numberOfRings=e.numberOfRings??6,this._vertexFormat=e.vertexFormat??m.VertexFormat.DEFAULT,this._workerPath=(0,m.buildModuleUrl)("IonSdkGeometryWorkers/createFanOutlineGeometry.js")}ne.createGeometry=function(e){if(!(0,m.defined)(e))throw new m.DeveloperError("fanGeometry is required");let i=e._radius,t=(0,m.defined)(e._perDirectionRadius)&&e._perDirectionRadius,a=e._directions,n=e._vertexFormat,o=e._numberOfRings,s,g,c,r,v=0,y,w=a.length,S=new m.GeometryAttributes;if(n.position){for(g=0,r=w*3*o,y=new Float64Array(r),c=0;c<o;c++)for(s=0;s<w;s++){F=m.Cartesian3.fromSpherical(a[s],F);let O=t?m.Cartesian3.magnitude(F):i,D=O/o*(c+1);F=m.Cartesian3.normalize(F,F),y[g++]=F.x*D,y[g++]=F.y*D,y[g++]=F.z*D,v=Math.max(v,O)}S.position=new m.GeometryAttribute({componentDatatype:m.ComponentDatatype.DOUBLE,componentsPerAttribute:3,values:y})}g=0,r=w*2*o;let b=m.IndexDatatype.createTypedArray(r/3,r);for(c=0;c<o;c++){let O=c*w;for(s=0;s<w-1;s++)b[g++]=s+O,b[g++]=s+1+O;b[g++]=s+O,b[g++]=0+O}return new m.Geometry({attributes:S,indices:b,primitiveType:m.PrimitiveType.LINES,boundingSphere:new m.BoundingSphere(m.Cartesian3.ZERO,v)})};var Y=ne;var x=I(V(),1);var d=I(V(),1);var oe=new d.Color,we=new d.Cartesian3,re=new d.ConstantProperty(6);function De(e){this.id=e,this.vertexFormat=void 0,this.directions=void 0,this.radius=void 0,this.perDirectionRadius=void 0,this.numberOfRings=void 0}function E(e,i){d.GeometryUpdater.call(this,{entity:e,scene:i,geometryOptions:new De(e),geometryPropertyName:"fan",observedPropertyNames:["availability","position","fan"]}),this._onEntityPropertyChanged(e,"fan",e.fan,void 0)}(0,d.defined)(Object.create)&&(E.prototype=Object.create(d.GeometryUpdater.prototype),E.prototype.constructor=E);E.prototype.createFillGeometryInstance=function(e){if(d.Check.defined("time",e),!this._fillEnabled)throw new d.DeveloperError("This instance does not represent a filled geometry.");let i=this._entity,t=i.isAvailable(e),a,n,o=new d.ShowGeometryInstanceAttribute(t&&i.isShowing&&this._showProperty.getValue(e)&&this._fillProperty.getValue(e)),s=this._distanceDisplayConditionProperty.getValue(e),g=d.DistanceDisplayConditionGeometryInstanceAttribute.fromDistanceDisplayCondition(s);if(this._materialProperty instanceof d.ColorMaterialProperty){let c;(0,d.defined)(this._materialProperty.color)&&(this._materialProperty.color.isConstant||t)&&(c=this._materialProperty.color.getValue(e,oe)),(0,d.defined)(c)||(c=d.Color.WHITE),n=d.ColorGeometryInstanceAttribute.fromColor(c),a={show:o,distanceDisplayCondition:g,color:n}}else a={show:o,distanceDisplayCondition:g};return new d.GeometryInstance({id:i,geometry:new H(this._options),modelMatrix:i.computeModelMatrix(e),attributes:a})};E.prototype.createOutlineGeometryInstance=function(e){if(d.Check.defined("time",e),!this._outlineEnabled)throw new d.DeveloperError("This instance does not represent an outlined geometry.");let i=this._entity,t=i.isAvailable(e),a=d.Property.getValueOrDefault(this._outlineColorProperty,e,d.Color.BLACK,oe),n=this._distanceDisplayConditionProperty.getValue(e);return new d.GeometryInstance({id:i,geometry:new Y(this._options),modelMatrix:i.computeModelMatrix(e),attributes:{show:new d.ShowGeometryInstanceAttribute(t&&this._showProperty.getValue(e)&&this._showOutlineProperty.getValue(e)),color:d.ColorGeometryInstanceAttribute.fromColor(a),distanceDisplayCondition:d.DistanceDisplayConditionGeometryInstanceAttribute.fromDistanceDisplayCondition(n)}})};E.prototype._isHidden=function(e,i){return!(0,d.defined)(e.position)||!(0,d.defined)(i.perDirectionRadius)&&!(0,d.defined)(i.radius)||d.GeometryUpdater.prototype._isHidden.call(this,e,i)};E.prototype._isDynamic=function(e,i){return!d.Property.isConstant(e.position)||!d.Property.isConstant(e.orientation)||!d.Property.isConstant(i.perDirectionRadius)||!d.Property.isConstant(i.radius)||!d.Property.isConstant(i.directions)||!d.Property.isConstant(i.outlineWidth)||!d.Property.isConstant(i.numberOfRings)};E.prototype._getIsClosed=function(){return!1};E.prototype._setStaticOptions=function(e,i){let t=this._materialProperty instanceof d.ColorMaterialProperty,a=i.numberOfRings??re,n=this._options;n.vertexFormat=t?d.PerInstanceColorAppearance.VERTEX_FORMAT:d.MaterialAppearance.VERTEX_FORMAT,n.directions=i.directions.getValue(d.Iso8601.MINIMUM_VALUE,n.directions),n.radius=(0,d.defined)(i.radius)?i.radius.getValue(d.Iso8601.MINIMUM_VALUE):void 0,n.perDirectionRadius=(0,d.defined)(i.perDirectionRadius)?i.perDirectionRadius.getValue(d.Iso8601.MINIMUM_VALUE):void 0,n.numberOfRings=a.getValue(d.Iso8601.MINIMUM_VALUE)};E.DynamicGeometryUpdater=k;function k(e,i,t){d.DynamicGeometryUpdater.call(this,e,i,t)}(0,d.defined)(Object.create)&&(k.prototype=Object.create(d.DynamicGeometryUpdater.prototype),k.prototype.constructor=k);k.prototype._isHidden=function(e,i,t){let a=d.Property.getValueOrUndefined(e.position,t,we),n=this._options;return!(0,d.defined)(a)||!(0,d.defined)(n.perDirectionRadius)&&!(0,d.defined)(n.radius)||d.DynamicGeometryUpdater.prototype._isHidden.call(this,e,i,t)};k.prototype._setOptions=function(e,i,t){let a=i.radius,n=i.perDirectionRadius,o=i.numberOfRings??re,s=this._options;s.directions=i.directions.getValue(t,s.directions),s.radius=(0,d.defined)(a)?a.getValue(t):void 0,s.perDirectionRadius=(0,d.defined)(n)?n.getValue(t):void 0,s.numberOfRings=o.getValue(t)};var J=E;var _=I(V(),1);function W(e){this._show=void 0,this._showSubscription=void 0,this._radius=void 0,this._radiusSubscription=void 0,this._perDirectionRadius=void 0,this._perDirectionRadiusSubscription=void 0,this._directions=void 0,this._directionsSubscription=void 0,this._material=void 0,this._materialSubscription=void 0,this._fill=void 0,this._fillSubscription=void 0,this._outline=void 0,this._outlineSubscription=void 0,this._outlineColor=void 0,this._outlineColorSubscription=void 0,this._outlineWidth=void 0,this._outlineWidthSubscription=void 0,this._numberOfRings=void 0,this._numberOfRingsSubscription=void 0,this._shadows=void 0,this._shadowsSubscription=void 0,this._distanceDisplayCondition=void 0,this._distanceDisplayConditionSubscription=void 0,this._definitionChanged=new _.Event,this.merge(e??_.Frozen.EMPTY_OBJECT)}Object.defineProperties(W.prototype,{definitionChanged:{get:function(){return this._definitionChanged}},show:(0,_.createPropertyDescriptor)("show"),radius:(0,_.createPropertyDescriptor)("radius"),perDirectionRadius:(0,_.createPropertyDescriptor)("perDirectionRadius"),directions:(0,_.createPropertyDescriptor)("directions"),material:(0,_.createMaterialPropertyDescriptor)("material"),fill:(0,_.createPropertyDescriptor)("fill"),outline:(0,_.createPropertyDescriptor)("outline"),outlineColor:(0,_.createPropertyDescriptor)("outlineColor"),outlineWidth:(0,_.createPropertyDescriptor)("outlineWidth"),numberOfRings:(0,_.createPropertyDescriptor)("numberOfRings"),shadows:(0,_.createPropertyDescriptor)("shadows"),distanceDisplayCondition:(0,_.createPropertyDescriptor)("distanceDisplayCondition")});W.prototype.clone=function(e){return(0,_.defined)(e)||(e=new W),e.show=this.show,e.radius=this.radius,e.perDirectionRadius=this.perDirectionRadius,e.directions=this.directions,e.material=this.material,e.fill=this.fill,e.outline=this.outline,e.outlineColor=this.outlineColor,e.outlineWidth=this.outlineWidth,e.numberOfRings=this.numberOfRings,e.shadows=this.shadows,e.distanceDisplayCondition=this.distanceDisplayCondition,e};W.prototype.merge=function(e){if(!(0,_.defined)(e))throw new _.DeveloperError("source is required.");this.show=this.show??e.show,this.radius=this.radius??e.radius,this.perDirectionRadius=this.perDirectionRadius??e.perDirectionRadius,this.directions=this.directions??e.directions,this.material=this.material??e.material,this.fill=this.fill??e.fill,this.outline=this.outline??e.outline,this.outlineColor=this.outlineColor??e.outlineColor,this.outlineWidth=this.outlineWidth??e.outlineWidth,this.numberOfRings=this.numberOfRings??e.numberOfRings,this.shadows=this.shadows??e.shadows,this.distanceDisplayCondition=this.distanceDisplayCondition??e.distanceDisplayCondition};var L=W;var f=I(V(),1);function be(e){let i=e.length,t=new Array(i/2);for(let a=0;a<i;a+=2){let n=a/2;t[n]=new f.Spherical(e[a],e[a+1])}return t}function Ce(e){let i=e.length,t=new Array(i/3);for(let a=0;a<i;a+=3){let n=a/3;t[n]=new f.Spherical(e[a],e[a+1],e[a+2])}return t}function se(e,i,t,a){(0,f.defined)(t.unitSpherical)?t.array=be(t.unitSpherical):(0,f.defined)(t.spherical)?t.array=Ce(t.spherical):(0,f.defined)(t.unitCartesian)?t.array=f.Cartesian3.unpackArray(t.unitCartesian).map(function(n){let o=f.Spherical.fromCartesian3(n);return f.Spherical.normalize(o,o)}):(0,f.defined)(t.cartesian)&&(t.array=f.Cartesian3.unpackArray(t.cartesian).map(function(n){return f.Spherical.fromCartesian3(n)})),(0,f.defined)(t.array)&&f.CzmlDataSource.processPacketData(Array,e,i,t,void 0,void 0,a)}function xe(e,i,t,a){if((0,f.defined)(t))if(Array.isArray(t))for(let n=0,o=t.length;n<o;n++)se(e,i,t[n],a);else se(e,i,t,a)}function B(e,i,t,a){let n=i.agi_fan;if(!(0,f.defined)(n))return;let o=n.interval;(0,f.defined)(o)&&(o=f.TimeInterval.fromIso8601(o));let s=e.fan;(0,f.defined)(s)||(e.fan=s=new L),f.CzmlDataSource.processPacketData(Boolean,s,"show",n.show,o,a,t),xe(s,"directions",n.directions,t),f.CzmlDataSource.processPacketData(Number,s,"radius",n.radius,o,a,t),f.CzmlDataSource.processMaterialPacketData(s,"material",n.material,o,a,t),f.CzmlDataSource.processPacketData(Boolean,s,"perDirectionRadius",n.perDirectionRadius,o,a,t),f.CzmlDataSource.processPacketData(Boolean,s,"fill",n.fill,o,a,t),f.CzmlDataSource.processPacketData(Boolean,s,"outline",n.outline,o,a,t),f.CzmlDataSource.processPacketData(f.Color,s,"outlineColor",n.outlineColor,o,a,t),f.CzmlDataSource.processPacketData(Number,s,"outlineWidth",n.outlineWidth,o,a,t),f.CzmlDataSource.processPacketData(Number,s,"numberOfRings",n.numberOfRings,o,a,t),f.CzmlDataSource.processPacketData(f.ShadowMode,s,"shadows",n.shadows,o,a,t)}var P=I(V(),1);function N(e){this._color=void 0,this._colorSubscription=void 0,this._show=void 0,this._showSubscription=void 0,this._direction=void 0,this._directionSubscription=void 0,this._length=void 0,this._lengthSubscription=void 0,this._minimumLengthInPixels=void 0,this._minimumLengthInPixelsSubscription=void 0,this._definitionChanged=new P.Event,this.merge(e??P.Frozen.EMPTY_OBJECT)}Object.defineProperties(N.prototype,{definitionChanged:{get:function(){return this._definitionChanged}},color:(0,P.createPropertyDescriptor)("color"),show:(0,P.createPropertyDescriptor)("show"),direction:(0,P.createPropertyDescriptor)("direction"),length:(0,P.createPropertyDescriptor)("length"),minimumLengthInPixels:(0,P.createPropertyDescriptor)("minimumLengthInPixels")});N.prototype.clone=function(e){return(0,P.defined)(e)||(e=new N),e.color=this.color,e.direction=this.direction,e.length=this.length,e.minimumLengthInPixels=this.minimumLengthInPixels,e.show=this.show,e};N.prototype.merge=function(e){if(!(0,P.defined)(e))throw new P.DeveloperError("source is required.");this.color=this.color??e.color,this.direction=this.direction??e.direction,this.length=this.length??e.length,this.minimumLengthInPixels=this.minimumLengthInPixels??e.minimumLengthInPixels,this.show=this.show??e.show};var G=N;var C=I(V(),1);var ae={iso8601:void 0};function U(e,i,t,a){let n=i.agi_vector;if(!(0,C.defined)(n))return;let o,s=n.interval;(0,C.defined)(s)&&(ae.iso8601=s,o=C.TimeInterval.fromIso8601(ae));let g=e.vector;(0,C.defined)(g)||(e.vector=g=new G),C.CzmlDataSource.processPacketData(C.Color,g,"color",n.color,o,a,t),C.CzmlDataSource.processPacketData(Boolean,g,"show",n.show,o,a,t),C.CzmlDataSource.processPacketData(C.Cartesian3,g,"direction",n.direction,o,a,t),C.CzmlDataSource.processPacketData(Number,g,"length",n.length,o,a,t),C.CzmlDataSource.processPacketData(Number,g,"minimumLengthInPixels",n.minimumLengthInPixels,o,a,t)}var u=I(V(),1);var p=I(V(),1);function q(e){e=e??p.Frozen.EMPTY_OBJECT,this.show=e.show??!0,this.length=e.length??1,this.minimumLengthInPixels=e.minimumLengthInPixels??0,this.color=p.Color.clone(e.color??p.Color.WHITE),this.id=e.id,this._allowPicking=e.allowPicking??!0,this.debugShowBoundingVolume=e.debugShowBoundingVolume??!1,this.debugWireframe=e.debugWireframe??!1,this._position=p.Cartesian3.clone(e.position??p.Cartesian3.ZERO),this._direction=p.Cartesian3.clone(e.direction??p.Cartesian3.UNIT_Y),this._modelMatrixDirty=!0,this._model=void 0;let i={primitive:this};p.Model.fromGltfAsync({url:(0,p.buildModuleUrl)("IonSdkGeometry/Assets/Models/Vector/Vector.glb"),enableDebugWireframe:!0,asynchronous:!1,pickObject:i,allowPicking:this.allowPicking}).then(t=>this._model=t).catch(t=>{this.isDestroyed()||console.log(`Error creating vector: ${t}`)})}Object.defineProperties(q.prototype,{position:{get:function(){return this._position},set:function(e){if(!(0,p.defined)(e))throw new p.DeveloperError("position is required.");p.Cartesian3.clone(e,this._position),this._modelMatrixDirty=!0}},direction:{get:function(){return this._direction},set:function(e){if(!(0,p.defined)(e))throw new p.DeveloperError("direction is required.");p.Cartesian3.clone(e,this._direction),this._modelMatrixDirty=!0}},allowPicking:{get:function(){return this._allowPicking}}});var de=new p.Cartesian3,ce=new p.Cartesian3;q.prototype.update=function(e){let i=this._model;if((0,p.defined)(i)){if(i.show=this.show,i.id=this.id,i.scale=this.length,i.minimumPixelSize=this.minimumLengthInPixels,i.debugShowBoundingVolume=this.debugShowBoundingVolume,i.debugWireframe=this.debugWireframe,i.color=this.color,this._modelMatrixDirty){this._modelMatrixDirty=!1;let t=this.direction,a,n;p.Math.equalsEpsilon(t.x,0,p.Math.EPSILON14)&&p.Math.equalsEpsilon(t.y,0,p.Math.EPSILON14)?(a=p.Cartesian3.cross(t,p.Cartesian3.UNIT_Y,de),n=p.Cartesian3.cross(a,t,ce)):(a=p.Cartesian3.cross(t,p.Cartesian3.UNIT_Z,de),n=p.Cartesian3.cross(a,t,ce));let o=i.modelMatrix;o[0]=a.x,o[1]=a.y,o[2]=a.z,o[3]=0,o[4]=-n.x,o[5]=-n.y,o[6]=-n.z,o[7]=0,o[8]=t.x,o[9]=t.y,o[10]=t.z,o[11]=0;let s=this.position;o[12]=s.x,o[13]=s.y,o[14]=s.z,o[15]=1}return i.update(e)}};q.prototype.isDestroyed=function(){return!1};q.prototype.destroy=function(){return this._model=this._model&&this._model.destroy(),(0,p.destroyObject)(this)};var Z=q;var Pe=u.Color.WHITE,ve=1,Oe=0,X=new u.Cartesian3;function M(e,i){if(!(0,u.defined)(e))throw new u.DeveloperError("scene is required.");if(!(0,u.defined)(i))throw new u.DeveloperError("entityCollection is required.");i.collectionChanged.addEventListener(M.prototype._onCollectionChanged,this),this._scene=e,this._primitives=e.primitives,this._entityCollection=i,this._hash={},this._entitiesToVisualize=new u.AssociativeArray,this._onCollectionChanged(i,i.values,[],[])}M.prototype.update=function(e){if(!(0,u.defined)(e))throw new u.DeveloperError("time is required.");let i=this._entitiesToVisualize.values,t=this._hash,a=this._primitives;for(let n=0,o=i.length;n<o;n++){let s=i[n],g=s._vector,c,r=t[s.id],v=s.isShowing&&s.isAvailable(e)&&u.Property.getValueOrDefault(g._show,e,!0);if(v&&(X=u.Property.getValueOrUndefined(s._position,e,X),c=u.Property.getValueOrUndefined(g._direction,e,c),v=(0,u.defined)(X)&&(0,u.defined)(c)),!v){(0,u.defined)(r)&&(r.show=!1);continue}(0,u.defined)(r)||(r=new Z({color:u.Color.WHITE,id:s}),r.id=s,a.add(r),t[s.id]=r),r.show=!0,r.position=X,r.direction=u.Cartesian3.normalize(c,c),r.length=u.Property.getValueOrDefault(g._length,e,ve),r.minimumLengthInPixels=u.Property.getValueOrDefault(g._minimumLengthInPixels,e,Oe),r.color=u.Property.getValueOrDefault(g._color,e,Pe)}return!0};M.prototype.isDestroyed=function(){return!1};M.prototype.destroy=function(){this._entityCollection.collectionChanged.removeEventListener(M.prototype._onCollectionChanged,this);let e=this._entitiesToVisualize.values,i=this._hash,t=this._primitives;for(let a=e.length-1;a>-1;a--)Q(this,e[a],i,t);return(0,u.destroyObject)(this)};M.prototype.getBoundingSphere=function(e,i){if(!(0,u.defined)(e))throw new u.DeveloperError("entity is required.");if(!(0,u.defined)(i))throw new u.DeveloperError("result is required.");let t=this._hash[e.id];return(0,u.defined)(t)?(i.center=u.Cartesian3.clone(t.position,i.center),i.radius=t.length,u.BoundingSphereState.DONE):u.BoundingSphereState.FAILED};M.prototype._onCollectionChanged=function(e,i,t,a){let n,o,s=this._entitiesToVisualize,g=this._hash,c=this._primitives;for(n=i.length-1;n>-1;n--)o=i[n],(0,u.defined)(o._vector)&&(0,u.defined)(o._position)&&s.set(o.id,o);for(n=a.length-1;n>-1;n--)o=a[n],(0,u.defined)(o._vector)&&(0,u.defined)(o._position)?s.set(o.id,o):(Q(this,o,g,c),s.remove(o.id));for(n=t.length-1;n>-1;n--)o=t[n],Q(this,o,g,c),s.remove(o.id)};function Q(e,i,t,a){let n=t[i.id];(0,u.defined)(n)&&(a.remove(n),n.isDestroyed()||n.destroy(),delete t[i.id])}var K=M;function $(){if(x.DataSourceDisplay&&x.CzmlDataSource&&x.Entity&&x.GeometryVisualizer)x.DataSourceDisplay.registerVisualizer(K),x.CzmlDataSource.registerUpdater(B),x.CzmlDataSource.registerUpdater(U),x.Entity.registerEntityType("fan",L),x.Entity.registerEntityType("vector",G),x.GeometryVisualizer.registerUpdater(J);else throw new x.DeveloperError("attempted to initialize sensors code before CesiumJS core")}$();globalThis.ION_SDK_VERSION="1.128";return _e(Re);})();
//# sourceMappingURL=IonSdkGeometry.js.map
